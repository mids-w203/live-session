<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This is the live-session notebook for class discussion for the UC Berkeley School of Information, Masters in Data Science course called Statistics for Data Science.">

<title>5&nbsp; Learning from Random Samples – Statistics for Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-hypothesis-testing.html" rel="next">
<link href="./sampling-and-testing.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sampling-and-testing.html">Sampling and Testing</a></li><li class="breadcrumb-item"><a href="./05-sampling-theory.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Learning from Random Samples</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mids-w203-live-session" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Live Session</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./probability-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilty Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-probability-spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Spaces</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-random-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Defining Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-summarizing-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarizing Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-conditional-expectation-and-BLP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conditional Expectation and The BLP</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sampling-and-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling and Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-sampling-theory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Learning from Random Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-comparing-two-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comparing Two Groups</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-regression-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">OLS Regression Estimates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-regression-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">OLS Regression Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-descriptive-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Descriptive Model Building</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-causal-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Explanatory Model Building</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-classical-linear-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Classical Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-reproducible-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#goals-framework-and-learning-objectives" id="toc-goals-framework-and-learning-objectives" class="nav-link active" data-scroll-target="#goals-framework-and-learning-objectives"><span class="header-section-number">5.1</span> Goals, Framework, and Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#class-announcements" id="toc-class-announcements" class="nav-link" data-scroll-target="#class-announcements"><span class="header-section-number">5.1.1</span> Class Announcements</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives"><span class="header-section-number">5.1.2</span> Learning Objectives</a></li>
  <li><a href="#roadmap" id="toc-roadmap" class="nav-link" data-scroll-target="#roadmap"><span class="header-section-number">5.1.3</span> Roadmap</a></li>
  </ul></li>
  <li><a href="#key-terms-and-assumptions" id="toc-key-terms-and-assumptions" class="nav-link" data-scroll-target="#key-terms-and-assumptions"><span class="header-section-number">5.2</span> Key Terms and Assumptions</a>
  <ul class="collapse">
  <li><a href="#iid" id="toc-iid" class="nav-link" data-scroll-target="#iid"><span class="header-section-number">5.2.1</span> IID</a></li>
  </ul></li>
  <li><a href="#estimators" id="toc-estimators" class="nav-link" data-scroll-target="#estimators"><span class="header-section-number">5.3</span> Estimators</a>
  <ul class="collapse">
  <li><a href="#three-properties-of-estimators" id="toc-three-properties-of-estimators" class="nav-link" data-scroll-target="#three-properties-of-estimators"><span class="header-section-number">5.3.1</span> Three properties of estimators</a></li>
  </ul></li>
  <li><a href="#estimator-property-biased-or-unbiased" id="toc-estimator-property-biased-or-unbiased" class="nav-link" data-scroll-target="#estimator-property-biased-or-unbiased"><span class="header-section-number">5.4</span> Estimator Property: Biased or Unbiased?</a>
  <ul class="collapse">
  <li><a href="#is-it-unbiased-with-data" id="toc-is-it-unbiased-with-data" class="nav-link" data-scroll-target="#is-it-unbiased-with-data"><span class="header-section-number">5.4.1</span> Is it unbiased, with data?</a></li>
  </ul></li>
  <li><a href="#estimator-property-consistency" id="toc-estimator-property-consistency" class="nav-link" data-scroll-target="#estimator-property-consistency"><span class="header-section-number">5.5</span> Estimator Property: Consistency</a></li>
  <li><a href="#understanding-sampling-distributions" id="toc-understanding-sampling-distributions" class="nav-link" data-scroll-target="#understanding-sampling-distributions"><span class="header-section-number">5.6</span> Understanding Sampling Distributions</a></li>
  <li><a href="#write-code-to-demo-the-central-limit-theorem-clt" id="toc-write-code-to-demo-the-central-limit-theorem-clt" class="nav-link" data-scroll-target="#write-code-to-demo-the-central-limit-theorem-clt"><span class="header-section-number">5.7</span> Write Code to Demo the Central Limit Theorem (CLT)</a>
  <ul class="collapse">
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1"><span class="header-section-number">5.7.1</span> Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2"><span class="header-section-number">5.7.2</span> Part 2</a></li>
  <li><a href="#part-3" id="toc-part-3" class="nav-link" data-scroll-target="#part-3"><span class="header-section-number">5.7.3</span> Part 3</a></li>
  <li><a href="#discussion-questions-about-the-clt" id="toc-discussion-questions-about-the-clt" class="nav-link" data-scroll-target="#discussion-questions-about-the-clt"><span class="header-section-number">5.7.4</span> Discussion Questions About the CLT</a></li>
  </ul></li>
  <li><a href="#errors-with-standard-errors" id="toc-errors-with-standard-errors" class="nav-link" data-scroll-target="#errors-with-standard-errors"><span class="header-section-number">5.8</span> Errors with Standard Errors</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sampling-and-testing.html">Sampling and Testing</a></li><li class="breadcrumb-item"><a href="./05-sampling-theory.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Learning from Random Samples</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Learning from Random Samples</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/south_hall.jpeg" class="img-fluid figure-img"></p>
<figcaption>south hall</figcaption>
</figure>
</div>
<p>This week, we’re coming into the big turn in the class, from probability theory to sampling theory.</p>
<p>In the probability theory section of the course, we developed the <em>theoretically</em> <strong>best</strong> possible set of models. Namely, we said that if our goal is to produce a model that minimizes the Mean Squared Error that <em>expectation</em> and <em>conditional expectation</em> are as good as it gets. That is, if we only have the outcome series, <span class="math inline">\(Y\)</span>, we cannot possibly improve upon <span class="math inline">\(E[Y]\)</span>, the expectation of the random variable <span class="math inline">\(Y\)</span>. If we have additional data on hand, say <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, then the best model of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> is the conditional expectation, <span class="math inline">\(E[Y|X]\)</span>.</p>
<p>We have also said that because this conditional expectation function might be complex, and hard to inform with data, that we might also be interested in a principled simplification of the conditional expectation function – the simplification that requires our model be a line.</p>
<p>With this simplification in mind, we derived the linear system that produces the minimum MSE: the ratio of covariance between variables to variance of the predictor:</p>
<p><span class="math display">\[
  \beta_{BLP} = \frac{Cov[Y,X]}{V[X]}.
\]</span></p>
<p>We noted, quickly, that the simple case of only two variables – an outcome and a single predictor – generalizes nicely into the (potentially very) many dimensional case. If the many-dimensional <span class="math inline">\(BLP\)</span> is denoted as <span class="math inline">\(g(\mathbf{X}) = b_{0} + b_{1}X_{1} + \dots + b_{k}X_{k}\)</span>, then we can arrive at the sloped between one particular predictor, <span class="math inline">\(X_{k}\)</span>, and the outcome, <span class="math inline">\(Y\)</span>, as:</p>
<p><span class="math display">\[
  b_{k} = \frac{\partial g(\mathbf{X})}{\partial X_{k}}.
\]</span></p>
<section id="goals-framework-and-learning-objectives" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="goals-framework-and-learning-objectives"><span class="header-section-number">5.1</span> Goals, Framework, and Learning Objectives</h2>
<section id="class-announcements" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="class-announcements"><span class="header-section-number">5.1.1</span> Class Announcements</h3>
<div class="goals">
<ul>
<li>You’re done with probability theory. <strong>Yay!</strong></li>
<li>You’re also done with your first test. <strong>Double Yay!</strong></li>
<li>We’re going to have a second test in a few weeks. Then we’re done testing for the semester <strong>Yay?</strong></li>
</ul>
</div>
</section>
<section id="learning-objectives" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">5.1.2</span> Learning Objectives</h3>
<div class="slide">
<p>At the end of this week, students will be able to</p>
<ol type="1">
<li><strong>Understand</strong> what iid sampling is, and evaluate whether the assumption of iid sampling is sufficiently plausible to engage in frequentist modeling.</li>
<li><strong>Appreciate</strong> that with iid sampling, summarizing functions of random variables are, themselves, random variables with probability distributions and values that they obtain.</li>
<li><strong>Recall</strong> definition of an estimator, <strong>state</strong> and <strong>understand</strong> the desirable properties of estimators, and <strong>evaluate</strong> whether an estimator possesses those desirable properties.</li>
<li><strong>Distinguish</strong> between the concepts of {expectation &amp; sample mean}, {variance &amp; unbiased sample variance estimator, sampling-based variance in the sample mean}.</li>
</ol>
</div>
</section>
<section id="roadmap" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="roadmap"><span class="header-section-number">5.1.3</span> Roadmap</h3>
<section id="where-were-going-coming-attractions" class="level4" data-number="5.1.3.1">
<h4 data-number="5.1.3.1" class="anchored" data-anchor-id="where-were-going-coming-attractions"><span class="header-section-number">5.1.3.1</span> Where We’re Going – Coming Attractions</h4>
<div class="slide">
<ul>
<li>We’re going to start bringing data into our work</li>
<li>First, we’re going to develop a testing framework that is built on sampling theory and reference distributions: these are the <strong>frequentist tests</strong>.</li>
<li>Second, we’re going to show that OLS regression is the sample estimator of the BLP. This means that OLS regression produces estimates of the BLP that have known convergence properties.</li>
<li>Third, we’re going combine the frequentist testing framework with OLS estimation to produce a full regression testing framework.</li>
</ul>
</div>
</section>
<section id="where-weve-been-random-variables-and-probability-theory" class="level4" data-number="5.1.3.2">
<h4 data-number="5.1.3.2" class="anchored" data-anchor-id="where-weve-been-random-variables-and-probability-theory"><span class="header-section-number">5.1.3.2</span> Where We’ve Been – Random Variables and Probability Theory</h4>
<p>Statisticians create a model (also known as the population model) to represent the world. This model exists as joint probability densities that govern the probabilities that any series of events occurs at the same time. This joint probability of outcomes can be summarized and described with lower-dimensional summaries like the expectation, variance, covariance. While the expectation is a summary that contains information on about one marginal distribution (i.e.&nbsp;the outcome we are interested in) we can produce predictive models that update, or <em>condition</em> the expectation based on other random variables. This summary, the <strong>conditional expectation</strong> is the best possible (measured in terms of minimizing mean squared error) predictor of an outcome. We might simplify this conditional expectation predictor in many ways; the most common is to simplify to the point that the predictor is constrained to be a line or plane. This is known as the Best Linear Predictor.</p>
</section>
<section id="where-we-are" class="level4" data-number="5.1.3.3">
<h4 data-number="5.1.3.3" class="anchored" data-anchor-id="where-we-are"><span class="header-section-number">5.1.3.3</span> Where we Are</h4>
<ul>
<li>We want to fit models – use data to set their parameter values.</li>
<li>A sample is a set of random variables</li>
<li>Sample statistics are functions of a sample, and they are random variables</li>
<li>Under iid and other assumptions, we get useful properties:
<ul>
<li>Statistics may be consistent estimators for population parameters</li>
<li>The distribution of sample statistics may be asymptotically normal</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="key-terms-and-assumptions" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="key-terms-and-assumptions"><span class="header-section-number">5.2</span> Key Terms and Assumptions</h2>
<section id="iid" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="iid"><span class="header-section-number">5.2.1</span> IID</h3>
<p>We use an abbreviation for the sampling process that under girds our frequentist statistics. That abbreviation, <strong>IID</strong>, while short, contains two powerful requirements of our data sampling process.</p>
<div class="definition">
<p>IID sampling is:</p>
<ol type="1">
<li><strong>Independent</strong>. The first <strong>I</strong> in the abbreviation, this independence requirement is similar to the independence concept that we’ve used in the probability theory section of the course. When samples are independent, the result of any one sample is not informative about the value of any of the other samples.</li>
<li><strong>Identically Distributed</strong>. The <strong>ID</strong> in the abbreviation, this requirement means that all samples are drawn from the same distribution.</li>
</ol>
</div>
<p>It might be tempting to imagine that IID samples are just <em>“random samples”</em>, but it is worth noting that IID sampling has the two specific requirements noted above, and that these requirements are more stringent than a “randomness” criteria.</p>
<p>When we are thinking about IID samples, and evaluating whether the sample do, in point of fact, meet both of the requirements, it is <em>crucial</em> to make an explicit statement about the reference population that is under consideration.</p>
<div class="discussion-question">
<p>For example, suppose that you were interested in learning about life-satisfaction and your reference population are the peoples who live in the United States. Further, suppose that you decide to produce an estimate of this using a sample drawn from UC Berkeley undergraduate students during <a href="https://teaching.berkeley.edu/sites/default/files/rrr_guidelines.pdf">RRR week</a>? There are several flaws in this design:</p>
</div>
<ol type="1">
<li>There is a key <strong>research design</strong> issue: a sample drawn from Berkeley undergraduates is going to be <em>essentially</em> uninformative of a US resident reference population!</li>
<li>There is a key <strong>statistical</strong> issue: the population of Berkeley undergraduates are not really an independent sample from the entire US resident reference population. Once you learn the age of someone from the Berkeley student population, you can make an conditional guess about the age of the next sample that will be closer than was possible before the first sample. The same goes for life-satisfaction: When you learn about the life-satisfaction from the first undergrad (who is miserable because they have their Stat 140 final coming up) while they are studying for their finals) you can make a conditionally better guess about the satisfaction of the next undergrad.</li>
</ol>
<p>Notice that these violations of the IID requirements only arise because our reference population is the US resident population. If, instead, the reference population were “Berkeley undergrads” then the sampling process <em>would</em> satisfy the requirements of an IID process.</p>
<div class="discussion-question">
<ul>
<li>How, or why, can a change in the reference population make an identical sampling process move from one that we can consider IID to one that we cannot consider IID?</li>
</ul>
</div>
<section id="it-this-iid" class="level4" data-number="5.2.1.1">
<h4 data-number="5.2.1.1" class="anchored" data-anchor-id="it-this-iid"><span class="header-section-number">5.2.1.1</span> It this IID?</h4>
<div class="discussion-question">
<p>For each of the following scenarios, is the IID assumption plausible?</p>
<ol type="1">
<li>Call a random phone number. If someone answers, interview all persons in the household. Repeat until you have data on 100 people.</li>
<li>Call a random phone number, interview the person if they are over 30. Repeat until you have data on 100 people.</li>
<li>Record year-to-date price change for 20 largest car manufacturers.</li>
<li>Measure net exports per GDP for all 195 countries recognized by the UN.</li>
</ol>
</div>
</section>
</section>
</section>
<section id="estimators" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="estimators"><span class="header-section-number">5.3</span> Estimators</h2>
<p>In our presentation of this week’s materials, we choose to switch the presentation of statistics and estimators, electing to discuss properties that we would like estimators to posses, before we actually introduce any specific estimators.</p>
<section id="three-properties-of-estimators" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="three-properties-of-estimators"><span class="header-section-number">5.3.1</span> Three properties of estimators</h3>
<div class="breakout">
<p>What are the three desirable properties of estimators?</p>
<ol type="1">
<li></li>
<li></li>
<li></li>
</ol>
<p>Is one these properties <em>more</em> important than another? If you had to force-rank these properties in terms of their importance, which is the most, and which the least important? Why?</p>
</div>
</section>
</section>
<section id="estimator-property-biased-or-unbiased" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="estimator-property-biased-or-unbiased"><span class="header-section-number">5.4</span> Estimator Property: Biased or Unbiased?</h2>
<div class="discussion-question">
<ol type="1">
<li>First, for a general case: Suppose that you have chosen some particular estimator, <span class="math inline">\(\hat{\theta}\)</span> to estimate some characteristic, <span class="math inline">\(\theta\)</span> of a random variable. How do you know if this estimator is unbiased?</li>
<li>Second, for a specific case: Define the “sample average” to be the following: <span class="math inline">\(\frac{1}{n}\sum_{i=1}^{N} x_{i}\)</span>. Prove that this sample average estimator is an unbiased estimator of <span class="math inline">\(E[X]\)</span>.</li>
<li>Third (easier), for a different specific case: Define the “smample smaverage” to be the following <span class="math inline">\(\frac{1}{n^2}\sum_{i=1}^{N} x_{i}\)</span>. Prove that the smample smaverage is a biased estimator of <span class="math inline">\(E[X]\)</span>.</li>
<li>Fourth (harder): Define the geometric mean to be <span class="math display">\[\left(\prod_{i=1}^{N}x_{i}\right)^{\frac{1}{N}}\]</span>. Prove that the geometric mean is a biased estimator of <span class="math inline">\(E[X]\)</span>.</li>
</ol>
</div>
<section id="is-it-unbiased-with-data" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="is-it-unbiased-with-data"><span class="header-section-number">5.4.1</span> Is it unbiased, with data?</h3>
<p>Suppose that you’re getting data from the following process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>random_distribution <span class="ot">&lt;-</span> <span class="cf">function</span>(number_samples) { </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">2.0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">2.1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  d3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  distribution_chooser <span class="ot">=</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(distribution_chooser <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    x_ <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>number_samples, <span class="at">min=</span>d1[<span class="dv">1</span>], <span class="at">max=</span>d1[<span class="dv">2</span>])  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(distribution_chooser <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    x_ <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>number_samples, <span class="at">min=</span>d2[<span class="dv">1</span>], <span class="at">max=</span>d2[<span class="dv">2</span>]) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(distribution_chooser <span class="sc">==</span> <span class="dv">3</span>) { </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    x_ <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>number_samples, <span class="at">min=</span>d3[<span class="dv">1</span>], <span class="at">max=</span>d3[<span class="dv">2</span>])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x_)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">random_distribution</span>(<span class="at">number_samples=</span><span class="dv">100000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.499851</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">random_distribution</span>(<span class="at">number_samples=</span><span class="dv">10000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.497246</code></pre>
</div>
</div>
<p>Notice that, there are two forms of inherent uncertainty in this function:</p>
<ol type="1">
<li>There is uncertainty about the distribution that we are getting draws from; and,</li>
<li>Within a distribution, we’re getting draws at random from a population distribution.</li>
</ol>
<p>This class of function, the <code>r*</code> functions, are the implementation of random generative processes within the R language. Look into <code>?distributions</code> as a class to see more about this process.</p>
<p>Suppose that you chose to use the same sample average estimator as a means of producing an estimate of the population expected value, <span class="math inline">\(E[X]\)</span>. Suppose that you get the following draws:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">random_distribution</span>(<span class="at">number_samples=</span><span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>draws</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.156497 2.036684 1.555414 1.941976 1.816770 1.874445 1.626519 1.192103
 [9] 1.688247 1.790409</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(draws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.667906</code></pre>
</div>
</div>
<div class="discussion-question">
<p>Is this sample average an unbiased estimator for the population expected value? How do you know?</p>
</div>
</section>
</section>
<section id="estimator-property-consistency" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="estimator-property-consistency"><span class="header-section-number">5.5</span> Estimator Property: Consistency</h2>
<p><em>Foundations</em> makes another of their jokes when they write, on page 105,</p>
<blockquote class="blockquote">
<p>“Consistency is a simple notion: if we had enough data, the probability that our estimate <span class="math inline">\(\hat{\theta}\)</span> would be far from the truth, <span class="math inline">\(\theta\)</span>, would be small.”</p>
</blockquote>
<div class="discussion-question">
<p><strong>How do we determine if a particular estimator,</strong> <span class="math inline">\(\hat{\theta}\)</span> is a consistent estimator for our parameter of interest?</p>
<p>There are at least two ways:</p>
<ol type="1">
<li>The estimator is unbiased, and has a sampling variance that decreases as we add data; or,</li>
<li>We can use Chebyshev’s to place a bound on the estimator, showing that as we add data, the estimator converges in probability to <span class="math inline">\(\theta\)</span>.</li>
</ol>
</div>
<p>The first notion of convergence requires an understanding of sampling variance:</p>
<p>The sampling variance of an estimator is a statement about how much dispersion due to random sampling, is present in the estimator. We defined the variance of a random variable to be <span class="math inline">\(E\left[(X - E[X])^{2}\right]\)</span>, The sampling variance uses this same definition, but we work with it slightly differently when we are considering sampling variance.</p>
<p>In particular, when we are considering sampling variance, we do not typically got as far as actually computing the variance of the underlying random variable? <em>Why?</em> Because, if we’re working in a sampling scenario, it is unlikely that we have access to the underlying function that governs the PDF of the random variable.</p>
<p>Instead, we typically start from a statement of the estimator that is under consideration, and apply the variance operator against that estimator. Consider, for example, forming a statement about the sampling variance of the sample average.</p>
<p>Let <span class="math inline">\(\overline{X} \equiv\)</span> “sample average” <span class="math inline">\(\equiv \frac{1}{n}\sum_{i=1}^{n}X_{i}\)</span> be the normal form of the sample average.</p>
<p>Earlier, we proved that <span class="math inline">\(\overline{X}\)</span> is an unbiased estimator of <span class="math inline">\(E[X]\)</span>.</p>
<div class="discussion-question">
<p>What is the sampling variance of the sample average?</p>
</div>
<p>&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;</p>
<div class="discussion-question">
<p>Using the statement that you have just produced, would you say that the sample average is a consistent estimator for the population expectation of a random variable?</p>
</div>
</section>
<section id="understanding-sampling-distributions" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="understanding-sampling-distributions"><span class="header-section-number">5.6</span> Understanding Sampling Distributions</h2>
<p>How do sampling distributions change as we add data to them? This is going to both motivate convergence, and also play forward into the Central Limit Theorem. Let’s work through an example that begins with a case that we can think through and draw ourselves. Once we feel pretty good about the <em>very</em> small sample, then we will rely on R to do the work when we expand the example beyond what we can draw ourselves.</p>
<div class="discussion-question">
<p>Suppose that <span class="math inline">\(X\)</span> is a Bernoulli random variable representing an unfair coin. Suppose that the coin has a 70% chance of coming up heads: <span class="math inline">\(P(X=1) = 0.7\)</span>.</p>
<ul>
<li>To begin, suppose that you take that coin, and you toss it two times: you have an iid sample of size 2, <span class="math inline">\((X_1,X_2)\)</span>.</li>
<li><em>What is the sampling distribution of the sample average, of this sample of size two?</em></li>
<li>On the axes below, draw the probability distribution of <span class="math inline">\(\overline X = \frac{X_1+X_2}{2}\)</span>.</li>
</ul>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-sampling-theory_files/figure-html/make axes-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="discussion-question">
<ul>
<li>What if you took four samples? What would the sampling distribution of <span class="math inline">\(\overline{X}\)</span> look like? <em>Draw this onto the axis above.</em></li>
<li>Explain the difference between a population distribution and the sampling distribution of a statistic.</li>
<li>Why do we want to know things about the sampling distribution of a statistic?</li>
</ul>
</div>
<p>We are going to write a function that, essentially, just wraps a built-in function with a new name and new function arguments. This is, generally, bad coding practice – because it is changing the default lexicon than a collaborator needs to be aware of – but it is useful for teaching purposes here.</p>
<ul>
<li>The <code>number_of_simulations</code> argument to the <code>toss_coin</code> function basically just adjusts the precision of our simulation study.</li>
<li>Let’s set, and keep this at <span class="math inline">\(1000\)</span> simulations. But, if you’re curious, you could set this to be <span class="math inline">\(5\)</span>, or <span class="math inline">\(10\)</span> and evaluate what happens.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>toss_coin <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_of_simulations=</span><span class="dv">1000</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_of_tosses=</span><span class="dv">2</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob_heads=</span><span class="fl">0.7</span>) { </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## number of simulations is just how many times we want to re-run the experiment</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## number of tosses is the number of coins we're going to toss.</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  number_of_heads <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span>number_of_simulations, <span class="at">size=</span>number_of_tosses, <span class="at">prob=</span>prob_heads)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  sample_average  <span class="ot">&lt;-</span> number_of_heads <span class="sc">/</span> number_of_tosses</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sample_average)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">toss_coin</span>(<span class="at">number_of_simulations=</span><span class="dv">10</span>, <span class="at">number_of_tosses=</span><span class="dv">2</span>, <span class="at">prob_heads=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0 1.0 1.0 0.5 1.0 0.0 0.5 0.5 1.0 1.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ncoins <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>coin_result_005 <span class="ot">&lt;-</span> <span class="fu">toss_coin</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_of_simulations =</span> <span class="dv">10000</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_of_tosses =</span> ncoins, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob_heads =</span> <span class="fl">0.005</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>coin_result_05 <span class="ot">&lt;-</span> <span class="fu">toss_coin</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_of_simulations =</span> <span class="dv">10000</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_of_tosses =</span> ncoins, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob_heads =</span> <span class="fl">0.5</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>plot_005 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>coin_result_005) <span class="sc">+</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.005</span>, <span class="at">color=</span><span class="st">'#003262'</span>, <span class="at">linewidth=</span><span class="dv">2</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>plot_05 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>coin_result_05) <span class="sc">+</span> </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">'#003262'</span>, <span class="at">linewidth=</span><span class="dv">2</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>plot_005 <span class="sc">/</span> </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  plot_05</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-sampling-theory_files/figure-html/toss coins and plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="discussion-question">
<p>In the plot that you have drawn above, pick some value, <span class="math inline">\(\epsilon\)</span> that is the distance away from the true expected value of this distribution.</p>
<ul>
<li>What proportion of the sampling distribution is further away than <span class="math inline">\(E[X] \pm \epsilon\)</span>?</li>
<li>When we toss the coin only two times, we can quickly draw out the distribution of <span class="math inline">\(\overline{X}\)</span>, and can form a statement about the <span class="math inline">\(P(E[X] - \epsilon \leq  \overline{X} \leq E[X] + \epsilon)\)</span>.</li>
<li>What if we toss the coin ten times? We can still use the IID nature of the coin to figure out the <em>true</em> <span class="math inline">\(P(\overline{X} = 0), P(\overline{X} = 1), \dots, P(\overline{X} = 10)\)</span>, but it is going to start to take some time. This is where we rely on the simulation to start speeding up our learning.</li>
<li>As we toss more and more coins, <span class="math inline">\(\overline X_{(100)} \rightarrow \overline X_{(10000)}\)</span> what will the value of <span class="math inline">\(\overline X\)</span> get closer to? What law generates this, and why does this law generate this result?</li>
</ul>
</div>
</section>
<section id="write-code-to-demo-the-central-limit-theorem-clt" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="write-code-to-demo-the-central-limit-theorem-clt"><span class="header-section-number">5.7</span> Write Code to Demo the Central Limit Theorem (CLT)</h2>
<p>When you were reading for this week, did you sense the palpable <em>joy</em> of the authors when they were writing about the central limit theorem?</p>
<blockquote class="blockquote">
<p>We now preset what is often considered the most profound and important theorem in statistics.</p>
</blockquote>
<p>Wow. What excitement.</p>
<p>On its own, the result that <em>across a broad range of generative functions the distribution of sample averages converges in distribution to follow a normal distribution</em> would be a statistical curiosity. Along the lines of “did you know that dinosaurs might have had feathers,” or, “avocado trees reproduce using ’protogynous dichogamy”. While these factoids might be useful on your quiz-bowl team, they don’t get us very far down the line as practicing data scientists.</p>
<p>However, there is a <strong>very</strong> useful consequence of this convergence in distribution that we will explore in detail over the coming two weeks: because <em>so many</em> distributions produce sample averages that converge in distribution to a normal distribution, we can put together a testing framework for sample averages that works for an <em>agnostic</em> set of random variables. Wait for that next week, but know that there’s a reason that we’re as excited about this statement as we are.</p>
<section id="part-1" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="part-1"><span class="header-section-number">5.7.1</span> Part 1</h3>
<p>To begin with, we will use fair coins that have an equal probability landing heads and tails.</p>
<div class="discussion-question">
<ol type="1">
<li>Modify the function argument below so that it conduct <strong>one</strong> simulations, and in each simulation tosses <strong>ten</strong> coins, each with an <strong>equal</strong> probability of landing heads and tails. Look into the <code>toss_coin</code> function: is there a point that this function is producing a sample average? If so, where?</li>
<li>Save values from the <code>toss_coin</code> function into an object, called <code>sample_mean</code>.</li>
</ol>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># toss_coin()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="discussion-question">
<p>The sample mean is a random variable – it is a function that maps from a random generative process’ sample space (the number of heads shown on dice) to the real numbers. To try to make this clear, visualize a larger number of simulations on the <code>toss_coin</code> function. That is, increase the <code>number_of_simulations</code> to be 10, or 100. and plot a histogram of the results. This is quite similar to what we have done earlier.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># toss_coin()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="discussion-question">
<p>If you replicate the simulation with <strong>ten</strong> coins enough times, will the distribution ever look normal? Why or why not?</p>
</div>
</section>
<section id="part-2" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="part-2"><span class="header-section-number">5.7.2</span> Part 2</h3>
<p>For this part, we’ll continue to study a fair coin.</p>
<div class="discussion-question">
<p>What happens if you change the number of coins that you’re tossing? Here, set <code>number_of_simulations=1000</code>, and examine what happens if you alter the number of coins that you’re tossing? Is there a point where this distribution starts to “look normal” to you? (Later in the semester, we’ll formalize a test for this “looks normal” concept).</p>
</div>
</section>
<section id="part-3" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="part-3"><span class="header-section-number">5.7.3</span> Part 3</h3>
<div class="discussion-question">
<p>What would happen if the coin was very, very unfair? For this part, study a coin that has a <code>prob_heads=0.01</code>. This is an example of a highly skewed random variable.</p>
<p>Start your study here tossing three coins, <code>number_of_coins=3</code>. What does this distribution look like?</p>
</div>
<div class="discussion-question">
<p>What happens as you increase the number of coins that you’re tossing? Is there a point that the distribution starts to look normal?</p>
</div>
</section>
<section id="discussion-questions-about-the-clt" class="level3" data-number="5.7.4">
<h3 data-number="5.7.4" class="anchored" data-anchor-id="discussion-questions-about-the-clt"><span class="header-section-number">5.7.4</span> Discussion Questions About the CLT</h3>
<div class="discussion-question">
<ol type="1">
<li>How does the skewness of the population distribution affect the applicability of the Central Limit Theorem? What lesson can you take for your practice of statistics?</li>
<li>Name a variable you would be interested in measuring that has a substantially skewed distribution.</li>
<li>One definition of a heavy tailed distribution is one with infinite variance. For example, you can use the <code>rcauchy</code> command in R to take draws from a Cauchy distribution, which has heavy tails. Do you think a “heavy tails” distribution will follow the CLT? What leads you to this intuition?</li>
</ol>
</div>
</section>
</section>
<section id="errors-with-standard-errors" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="errors-with-standard-errors"><span class="header-section-number">5.8</span> Errors with Standard Errors</h2>
<p>Talking about variance and sampling variance is hard, because the terms sound <strong>very</strong> similar, but have important distinctions in what they mean. For example, the “variance” is not the same as the “unbiased sample variance” which is also not the same as the “sampling variance of the sample average”. :sob:</p>
<p>Standard errors are a statement about the sampling variance of the sample average. But, related to this concept are the ideas of the <em>Population Variance</em>, the <em>Plug-In Estimator for the Sample Variance</em>, the <em>Unbiased Sample Variance</em>, and, finally, the <em>Sampling Variance of the Sample Average</em> (i.e the <em>Standard Error</em>).</p>
<p>How are each of these concepts related to one another, and how can we keep them all straight? As a group, fill out the following columns?</p>
<div class="discussion-question">
<p>For the <strong>Estimator Properties</strong> column, here we’re considering, principally biased/unbiased and consistent/inconsistent.</p>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Population Concept</th>
<th>Pop Notation</th>
<th>Sample Estimator</th>
<th>Sample Notation</th>
<th>Estimator Properties</th>
<th>Sampling Variance of Sample Estimator</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Expected Value</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Population Variance</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Population Covariance</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>CEF</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>BLP</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sampling-and-testing.html" class="pagination-link" aria-label="Sampling and Testing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Sampling and Testing</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-hypothesis-testing.html" class="pagination-link" aria-label="Hypothesis Testing">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>